%%% enable "DoubleSided" for paper-based submission, i.e. printing, and 
%%% remove it for the final submission, i.e. electronic thesis
%\newcommand*{\DoubleSided}{} 

\input{_global_settings.tex}



% Packages
\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amsthm,amssymb}
\usepackage{dsfont}
%\newtheorem{comment}{Comment}
\usepackage[utf8]{inputenc} 
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{color}
\usepackage{comment}
\usepackage{microtype}
\usepackage{wrapfig}
\usepackage{url}
\usepackage{subfig}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{enumitem,kantlipsum}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{blkarray}
\usepackage{adjustbox}
\usepackage{rotating}



%Hyperlink
\hypersetup{%
	colorlinks=true,% hyperlinks will be coloured
	linkcolor=blue,% hyperlink text will be green
	urlcolor  = blue,
	citecolor=purple
	%	linkbordercolor=red,% hyperlink border will be red
}


% Todo packages
\usepackage{xargs}
%\usepackage[pdftex,dvipsnames]{xcolor}
\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}



% Theorem
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{axiom}{Axiom}
\newtheorem{property}[theorem]{Property}
\newtheorem*{remark}{Remark}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{lemmarep}{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}{Example}[section]
\newtheorem{corollary}{Corollary}
\newtheorem{construction}[theorem]{Construction}
\usepackage{pgfplots}


%%Theorems in appendix with proper hrefs
\makeatletter
\newtheorem*{rep@theorem}{\rep@title}
\newcommand{\newreptheorem}[2]{%
	\newenvironment{rep#1}[1]{%
		\def\rep@title{\textbf{#2} \ref{##1}}%
		\begin{rep@theorem}}%
		{\end{rep@theorem}}}
\makeatother
\newreptheorem{theorem}{Theorem}
\newreptheorem{example}{Example}
\newreptheorem{proposition}{Proposition}


% Tikz
\usepackage{tikz}
\usetikzlibrary{automata}
\usetikzlibrary{bayesnet,arrows}
\usetikzlibrary{shapes,fit,calc,positioning}
\tikzset{box/.style={draw, diamond, thick, text centered, minimum height=0.5cm, minimum width=1cm, text width=0.9cm}}
\tikzset{line/.style={draw, thick, -latex'}}


% Macros
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\green}[1]{\textcolor{green}{#1}}


% Fairness 
%	Justicia
\newcommand{\justicia}{\ensuremath{\mathsf{Justicia}}}
\newcommand{\nonsensitive}{\ensuremath{\mathbf{X}}}
\newcommand{\sensitive}{\ensuremath{\mathbf{A}}}
\newcommand{\bool}{\ensuremath{B}}
\newcommand{\boolset}{\ensuremath{\mathbf{B}}}
\newcommand{\alg}{\mathcal{M}}
\newcommand{\R}{\ensuremath{\raisebox{\depth}{\rotatebox{180}{R}}}}
\newcommand{\justiciaenum}{\ensuremath{\mathsf{Justicia\_enum}}}
\newcommand{\justicialearn}{\ensuremath{\mathsf{Justicia\_infer}}}
\newcommand{\justiciacond}{\ensuremath{\mathsf{Justicia\_cond}}}
\newcommand{\numnonsensitive}{\ensuremath{m_1}}
\newcommand{\numsensitive}{\ensuremath{m_2}}
\newcommand{\abs}[1]{\ensuremath{\mid #1 \mid}}


%	FVGM
\newcommand{\fvgm}{\ensuremath{\mathsf{FVGM}}}
\newcommand{\mediator}{\ensuremath{\mathbf{Z}}}
\newcommand{\stochastic}{\ensuremath{\mathsf{S3P}}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand{\graph}{\ensuremath{G}}
\newcommand{\factors}{\ensuremath{\theta}}
\newcommand{\parent}{\ensuremath{\mathrm{Pa}}}
\newcommand{\BN}{\ensuremath{\mathsf{BN}}}

%	FairXplainer
\newcommand{\fairXplainer}{\ensuremath{\mathsf{FairXplainer}}}
\newcommand{\fiffunc}{\ensuremath{g}}
\newcommand{\feature}{\ensuremath{\mathbf{Z}}}
\newcommand{\numfeatures}{\ensuremath{m}}




% color
\definecolor{terminate}{gray}{0.8}
\definecolor{collision}{rgb}{0.2,1,0.3}
\definecolor{existential}{rgb}{0.9,0.9, 0.1}
\definecolor{affirmative}{rgb}{0.2,1,0.3}


% Interpretability
%		    Relaxed CNF
\newcommand{\Rule}{\ensuremath{{\mathcal{R}}}}
\newcommand{\clauseweight}[1]{\ensuremath{W \! \left( #1 \right)}}
%			\newcommand{\X}{{\mathbf{X}}}
\newcommand{\MaxSAT}{\ensuremath{\textsc{MaxSAT}}}
\newcommand{\noise}{\xi}
\newcommand{\card}{\eta}
\newcommand{\noclause}{k}
\newcommand{\crr}{\ensuremath{\mathsf{CRR}}}
\newcommand{\CNF}{\ensuremath{\mathsf{Card2CNF}}}
%			\newcommand{\B}{\mathbf{b}}
\newcommand{\clause}{\ensuremath{\mathsf{clause}}}
\newcommand{\MLIC}{\ensuremath{\mathsf{MLIC}}}
\newcommand{\IMLI}{\ensuremath{\mathsf{IMLI}}}
\newcommand{\ILP}{\ensuremath{\textsc{ILP}}}


%		Logic
\newcommand{\propformula}{\phi}
\newcommand{\propclause}{C}
\newcommand{\literal}{V}
\newcommand{\varquantifier}{Q}
\newcommand{\varweight}{W}
\newcommand{\ssatformula}{\Phi}

%		Bayesian Network
\newcommand{\graphvertices}{\mathbf{V}}
\newcommand{\graphvertex}{V}
\newcommand{\graphedges}{\mathbf{E}}
\newcommand{\graphedge}{E}
\newcommand{\bncomplexity}{C}
\newcommand{\bnnumdiscrete}{\mathsf{Card}}

%		Dataset
\newcommand{\dataset}{\mathbf{D}}
\newcommand{\datadistribution}{\mathcal{D}}

%	    IMLI
\newcommand{\imli}{\ensuremath{\mathsf{IMLI}}}

%\pagestyle{empty}
\begin{document}
\title{Interpretability and Fairness in Machine Learning: A Formal Methods Approach}
\author{Bishwamittra Ghosh}
%\prevdegrees{%
%  Ph.D.\ Candidate, National University of Singapore}
\degree{Doctor of Philosophy}
\field{Computer Science}
\degreeyear{2023}
\supervisor{Dr Kuldeep S.\ Meel}


% only involve the examiners in the final submission
\examiners{%
	Dr Harold Soh Soon Hong\\
Dr Reza Shokri
}

\maketitle

\declaredate{\today}
%\declaresign{\RootPicDir /signature.jpg} % remove this if you prefer to sign physically
\declarationpage

\begin{frontmatter}
%  \dedicate{To my parents}
  \input{chapters/acknowledgements.tex}
  \tableofcontents
  \input{chapters/abstract.tex}
  \input{chapters/list_of_papers.tex}
  \listofalgorithms
  \addcontentsline{toc}{chapter}{List of Algorithms}
  \listoffigures
  \listoftables
\end{frontmatter}


\part{Prologue}
\input{chapters/introduction.tex}
\input{chapters/background.tex}


\part{Interpretable Rule-based Machine Learning}
We discuss  an incremental learning framework based on MaxSAT for interpretable classification rules in Chapter~\ref{chapter:imli}. This allows us to scale up classification on large datasets. In Chapter~\ref{chapter:crr}, we improve the expressiveness of rule-based classifiers and apply incremental solving for an efficient learning.

% Interpretability
% IMLI
\chapter{Scalability via Incremental Learning}
\input{chapters/interpretability/imli/introduction}
\input{chapters/interpretability/imli/related_work}
\input{chapters/interpretability/imli/problem_formulation}
\input{chapters/interpretability/imli/baseline}
\input{chapters/interpretability/imli/incremental_learning}
\input{chapters/interpretability/imli/iterative_learning}
\input{chapters/interpretability/imli/experiment}
\input{chapters/interpretability/imli/conclusion}


% Relaxed CNF
\chapter{Expressiveness via Logical Relaxation}
\input{chapters/interpretability/relaxed-cnf/introduction.tex}
\input{chapters/interpretability/relaxed-cnf/problem_formulation.tex}
\input{chapters/interpretability/relaxed-cnf/ilp_formulation.tex}
\input{chapters/interpretability/relaxed-cnf/incremental_ilp.tex}
\input{chapters/interpretability/relaxed-cnf/experiment.tex}
\input{chapters/interpretability/relaxed-cnf/conclusion.tex}


\part{~Fairness in Machine Learning}

In Chapter~\ref{chapter:justicia}, we discuss an SSAT-based framework to formally verify the fairness of finite classifiers encoded as Boolean formulas. In Chapter~\ref{chapter:fvgm}, we handle feature correlations in fairness verification and discuss a tractable fairness verification of linear classifiers.

% Fairness
% Justicia
\chapter{Fairness Verification using SSAT}
\input{chapters/fairness/justicia/introduction.tex}
\input{chapters/fairness/justicia/framework.tex}
\input{chapters/fairness/justicia/practical.tex}
\input{chapters/fairness/justicia/experiments.tex}
\input{chapters/fairness/justicia/discussion.tex}

% FVGM
\chapter{Handling Feature Correlations in Fairness Verification}
\input{chapters/fairness/fvgm/introduction}
\input{chapters/fairness/fvgm/framework}
\input{chapters/fairness/fvgm/framework2}
\input{chapters/fairness/fvgm/evaluations}
%\input{chapters/fairness/fvgm/applications}
\input{chapters/fairness/fvgm/conclusion}
				





\part{~Epilogue}
In Chapter~\ref{chapter:fif}, we envision towards combining two research themes in the thesis: interpretability and fairness, and discuss an algorithmic framework to interpret  fairness in machine learning. In Chapter~\ref{chapter:conclusion}, we conclude the thesis and discuss future work.


%%		FairXplainer
\chapter{Interpreting Fairness: Identifying Sources of Bias}				
\input{chapters/fairness/fif/introduction.tex}
\input{chapters/fairness/fif/framework.tex}
\input{chapters/fairness/fif/fairxplainer.tex}
\input{chapters/fairness/fif/experiments.tex}
\input{chapters/fairness/fif/conclusion.tex}	


\input{chapters/conclusion.tex}
\bookmarksetup{startatroot}
\printbibliography[heading=bibintoc]


\appendix
\input{chapters/interpretability/imli/appendix.tex}
\input{chapters/fairness/fvgm/appendix.tex}
\input{chapters/fairness/fif/appendix.tex}
\end{document}
